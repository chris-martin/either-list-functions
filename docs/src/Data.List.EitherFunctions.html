<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE BlockArguments, LambdaCase, NoImplicitPrelude #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-comment">-- | Functions involving lists of 'Either'.</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data.List.EitherFunctions</span><span>
</span><span id="line-6"></span><span>  </span><span class="hs-special">(</span><span>
</span><span id="line-7"></span><span>
</span><span id="line-8"></span><span>    </span><span class="annot"><span class="hs-comment">{- * Map       -}</span></span><span>  </span><span class="annot"><a href="Data.List.EitherFunctions.html#partlyMap"><span class="hs-identifier">partlyMap</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-9"></span><span>    </span><span class="annot"><span class="hs-comment">{- * Group     -}</span></span><span>  </span><span class="annot"><a href="Data.List.EitherFunctions.html#groupEither"><span class="hs-identifier">groupEither</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-10"></span><span>    </span><span class="annot"><span class="hs-comment">{- * Partition -}</span></span><span>  </span><span class="annot"><a href="Data.List.EitherFunctions.html#partition"><span class="hs-identifier">partition</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-11"></span><span>    </span><span class="annot"><span class="hs-comment">{- * Span      -}</span></span><span>  </span><span class="annot"><a href="Data.List.EitherFunctions.html#spanLeft"><span class="hs-identifier">spanLeft</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.List.EitherFunctions.html#spanLeft%27"><span class="hs-identifier">spanLeft'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.List.EitherFunctions.html#spanRight"><span class="hs-identifier">spanRight</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.List.EitherFunctions.html#spanRight%27"><span class="hs-identifier">spanRight'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-12"></span><span>    </span><span class="annot"><span class="hs-comment">{- * Lead      -}</span></span><span>  </span><span class="annot"><a href="Data.List.EitherFunctions.html#leadLeft"><span class="hs-identifier">leadLeft</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.List.EitherFunctions.html#leadLeft%27"><span class="hs-identifier">leadLeft'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.List.EitherFunctions.html#leadRight"><span class="hs-identifier">leadRight</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.List.EitherFunctions.html#leadRight%27"><span class="hs-identifier">leadRight'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-13"></span><span>    </span><span class="annot"><span class="hs-comment">{- * Branch    -}</span></span><span>  </span><span class="annot"><a href="Data.List.EitherFunctions.html#branchLeft"><span class="hs-identifier">branchLeft</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.List.EitherFunctions.html#branchRight"><span class="hs-identifier">branchRight</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.List.EitherFunctions.html#BranchComparison"><span class="hs-identifier">BranchComparison</span></a></span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-16"></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Bool</span></span><span>                   </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Bool</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Either</span></span><span>                 </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Either</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Function</span></span><span>               </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">fix</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Functor.Contravariant</span></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Comparison</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">contramap</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span>                   </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">foldr</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">map</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">span</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Tree</span></span><span>                   </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Tree</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Forest</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>                  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">maybe</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Ord</span></span><span>                    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Ordering</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-27"></span><span class="hs-comment">-- &gt;&gt;&gt; import Prelude (even, show)</span><span>
</span><span id="line-28"></span><span class="hs-comment">--</span><span>
</span><span id="line-29"></span><span class="hs-comment">-- &gt;&gt;&gt; partlyMap (\x -&gt; if even x then Just (show x) else Nothing) [1..5]</span><span>
</span><span id="line-30"></span><span class="hs-comment">-- [Left 1,Right &quot;2&quot;,Left 3,Right &quot;4&quot;,Left 5]</span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span id="local-6989586621679026512"><span id="local-6989586621679026513"><span class="annot"><a href="Data.List.EitherFunctions.html#partlyMap"><span class="hs-identifier hs-type">partlyMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679026513"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679026512"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679026513"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679026513"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679026512"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span id="partlyMap"><span class="annot"><span class="annottext">partlyMap :: (a -&gt; Maybe b) -&gt; [a] -&gt; [Either a b]
</span><a href="Data.List.EitherFunctions.html#partlyMap"><span class="hs-identifier hs-var hs-var">partlyMap</span></a></span></span><span> </span><span id="local-6989586621679026511"><span class="annot"><span class="annottext">a -&gt; Maybe b
</span><a href="#local-6989586621679026511"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Either a b) -&gt; [a] -&gt; [Either a b]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679026510"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679026510"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either a b -&gt; (b -&gt; Either a b) -&gt; Maybe b -&gt; Either a b
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Either a b
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679026510"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">b -&gt; Either a b
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Maybe b
</span><a href="#local-6989586621679026511"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679026510"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-37"></span><span class="hs-comment">-- &gt;&gt;&gt; groupEither [Left 1, Left 2, Right 'a', Left 3, Right 'b', Right 'c']</span><span>
</span><span id="line-38"></span><span class="hs-comment">-- [Left [1,2],Right &quot;a&quot;,Left [3],Right &quot;bc&quot;]</span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span id="local-6989586621679026508"><span id="local-6989586621679026509"><span class="annot"><a href="Data.List.EitherFunctions.html#groupEither"><span class="hs-identifier hs-type">groupEither</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679026509"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679026508"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679026509"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679026508"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span id="groupEither"><span class="annot"><span class="annottext">groupEither :: [Either a b] -&gt; [Either [a] [b]]
</span><a href="Data.List.EitherFunctions.html#groupEither"><span class="hs-identifier hs-var hs-var">groupEither</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(([Either a b] -&gt; [Either [a] [b]])
 -&gt; [Either a b] -&gt; [Either [a] [b]])
-&gt; [Either a b] -&gt; [Either [a] [b]]
forall a. (a -&gt; a) -&gt; a
</span><span class="hs-identifier hs-var">fix</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679026507"><span class="annot"><span class="annottext">[Either a b] -&gt; [Either [a] [b]]
</span><a href="#local-6989586621679026507"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-43"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span>            </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-44"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span>  </span><span id="local-6989586621679026506"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679026506"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679026505"><span class="annot"><span class="annottext">[Either a b]
</span><a href="#local-6989586621679026505"><span class="hs-identifier hs-var">xs</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="annot"><span class="annottext">[a] -&gt; Either [a] [b]
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679026506"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679026504"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Either [a] [b] -&gt; [Either [a] [b]] -&gt; [Either [a] [b]]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Either a b] -&gt; [Either [a] [b]]
</span><a href="#local-6989586621679026507"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">[Either a b]
</span><a href="#local-6989586621679026503"><span class="hs-identifier hs-var">zs</span></a></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679026504"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679026504"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679026503"><span class="annot"><span class="annottext">[Either a b]
</span><a href="#local-6989586621679026503"><span class="hs-identifier hs-var">zs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Either a b] -&gt; ([a], [Either a b])
forall a b. [Either a b] -&gt; ([a], [Either a b])
</span><a href="Data.List.EitherFunctions.html#spanLeft"><span class="hs-identifier hs-var">spanLeft</span></a></span><span>  </span><span class="annot"><span class="annottext">[Either a b]
</span><a href="#local-6989586621679026505"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-45"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679026502"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679026502"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679026501"><span class="annot"><span class="annottext">[Either a b]
</span><a href="#local-6989586621679026501"><span class="hs-identifier hs-var">xs</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="annot"><span class="annottext">[b] -&gt; Either [a] [b]
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679026502"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; [b] -&gt; [b]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679026500"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Either [a] [b] -&gt; [Either [a] [b]] -&gt; [Either [a] [b]]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Either a b] -&gt; [Either [a] [b]]
</span><a href="#local-6989586621679026507"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">[Either a b]
</span><a href="#local-6989586621679026499"><span class="hs-identifier hs-var">zs</span></a></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679026500"><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679026500"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679026499"><span class="annot"><span class="annottext">[Either a b]
</span><a href="#local-6989586621679026499"><span class="hs-identifier hs-var">zs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Either a b] -&gt; ([b], [Either a b])
forall a b. [Either a b] -&gt; ([b], [Either a b])
</span><a href="Data.List.EitherFunctions.html#spanRight"><span class="hs-identifier hs-var">spanRight</span></a></span><span> </span><span class="annot"><span class="annottext">[Either a b]
</span><a href="#local-6989586621679026501"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-48"></span><span class="hs-comment">-- &gt;&gt;&gt; leadLeft [Right 'a', Right 'b', Left 1, Right 'c', Right 'd', Left 2, Right 'e', Right 'f']</span><span>
</span><span id="line-49"></span><span class="hs-comment">-- (&quot;ab&quot;,[(1,&quot;cd&quot;),(2,&quot;ef&quot;)])</span><span>
</span><span id="line-50"></span><span class="hs-comment">--</span><span>
</span><span id="line-51"></span><span class="hs-comment">-- &gt;&gt;&gt; leadLeft [Left 1, Left 2, Right 'a', Left 3, Right 'b', Right 'c']</span><span>
</span><span id="line-52"></span><span class="hs-comment">-- (&quot;&quot;,[(1,&quot;&quot;),(2,&quot;a&quot;),(3,&quot;bc&quot;)])</span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span id="local-6989586621679026497"><span id="local-6989586621679026498"><span class="annot"><a href="Data.List.EitherFunctions.html#leadLeft"><span class="hs-identifier hs-type">leadLeft</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679026498"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679026497"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679026497"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679026498"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679026497"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span id="leadLeft"><span class="annot"><span class="annottext">leadLeft :: [Either a b] -&gt; ([b], [(a, [b])])
</span><a href="Data.List.EitherFunctions.html#leadLeft"><span class="hs-identifier hs-var hs-var">leadLeft</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Either a b] -&gt; ([b], [(a, [b])])
forall a b. [Either a b] -&gt; ([b], [(a, [b])])
</span><a href="#local-6989586621679026496"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-57"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-58"></span><span>    </span><span id="local-6989586621679026496"><span class="annot"><span class="annottext">f :: [Either a b] -&gt; ([b], [(a, [b])])
</span><a href="#local-6989586621679026496"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679026495"><span class="annot"><span class="annottext">[Either a b]
</span><a href="#local-6989586621679026495"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679026494"><span class="hs-identifier hs-var">unledItems</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(a, [b])]
</span><a href="#local-6989586621679026493"><span class="hs-identifier hs-var">ledGroups</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-60"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679026494"><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679026494"><span class="hs-identifier hs-var">unledItems</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679026492"><span class="annot"><span class="annottext">Maybe (a, [Either a b])
</span><a href="#local-6989586621679026492"><span class="hs-identifier hs-var">ysMaybe</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Either a b] -&gt; ([b], Maybe (a, [Either a b]))
forall a b. [Either a b] -&gt; ([b], Maybe (a, [Either a b]))
</span><a href="Data.List.EitherFunctions.html#spanRight%27"><span class="hs-identifier hs-var">spanRight'</span></a></span><span> </span><span class="annot"><span class="annottext">[Either a b]
</span><a href="#local-6989586621679026495"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-61"></span><span>        </span><span id="local-6989586621679026493"><span class="annot"><span class="annottext">ledGroups :: [(a, [b])]
</span><a href="#local-6989586621679026493"><span class="hs-identifier hs-var hs-var">ledGroups</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (a, [Either a b])
</span><a href="#local-6989586621679026492"><span class="hs-identifier hs-var">ysMaybe</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-62"></span><span>            </span><span class="annot"><span class="annottext">Maybe (a, [Either a b])
</span><span class="hs-identifier hs-var">Nothing</span></span><span>            </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-63"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679026491"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679026491"><span class="hs-identifier hs-var">leader</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679026490"><span class="annot"><span class="annottext">[Either a b]
</span><a href="#local-6989586621679026490"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="annot"><span class="annottext">a -&gt; [Either a b] -&gt; [(a, [b])]
forall a b. a -&gt; [Either a b] -&gt; [(a, [b])]
</span><a href="#local-6989586621679026489"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679026491"><span class="hs-identifier hs-var">leader</span></a></span><span> </span><span class="annot"><span class="annottext">[Either a b]
</span><a href="#local-6989586621679026490"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span>    </span><span id="local-6989586621679026489"><span class="annot"><span class="annottext">r :: a -&gt; [Either a b] -&gt; [(a, [b])]
</span><a href="#local-6989586621679026489"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679026488"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679026488"><span class="hs-identifier hs-var">leader</span></a></span></span><span> </span><span id="local-6989586621679026487"><span class="annot"><span class="annottext">[Either a b]
</span><a href="#local-6989586621679026487"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a, [b])
</span><a href="#local-6989586621679026486"><span class="hs-identifier hs-var">firstGroup</span></a></span><span> </span><span class="annot"><span class="annottext">(a, [b]) -&gt; [(a, [b])] -&gt; [(a, [b])]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(a, [b])]
</span><a href="#local-6989586621679026485"><span class="hs-identifier hs-var">moreGroups</span></a></span><span>
</span><span id="line-66"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-67"></span><span>        </span><span id="local-6989586621679026486"><span class="annot"><span class="annottext">firstGroup :: (a, [b])
</span><a href="#local-6989586621679026486"><span class="hs-identifier hs-var hs-var">firstGroup</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679026488"><span class="hs-identifier hs-var">leader</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679026484"><span class="hs-identifier hs-var">followers</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679026484"><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679026484"><span class="hs-identifier hs-var">followers</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679026483"><span class="annot"><span class="annottext">Maybe (a, [Either a b])
</span><a href="#local-6989586621679026483"><span class="hs-identifier hs-var">ysMaybe</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Either a b] -&gt; ([b], Maybe (a, [Either a b]))
forall a b. [Either a b] -&gt; ([b], Maybe (a, [Either a b]))
</span><a href="Data.List.EitherFunctions.html#spanRight%27"><span class="hs-identifier hs-var">spanRight'</span></a></span><span> </span><span class="annot"><span class="annottext">[Either a b]
</span><a href="#local-6989586621679026487"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-69"></span><span>        </span><span id="local-6989586621679026485"><span class="annot"><span class="annottext">moreGroups :: [(a, [b])]
</span><a href="#local-6989586621679026485"><span class="hs-identifier hs-var hs-var">moreGroups</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (a, [Either a b])
</span><a href="#local-6989586621679026483"><span class="hs-identifier hs-var">ysMaybe</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-70"></span><span>            </span><span class="annot"><span class="annottext">Maybe (a, [Either a b])
</span><span class="hs-identifier hs-var">Nothing</span></span><span>             </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-71"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679026482"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679026482"><span class="hs-identifier hs-var">leader'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679026481"><span class="annot"><span class="annottext">[Either a b]
</span><a href="#local-6989586621679026481"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="annot"><span class="annottext">a -&gt; [Either a b] -&gt; [(a, [b])]
</span><a href="#local-6989586621679026489"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679026482"><span class="hs-identifier hs-var">leader'</span></a></span><span> </span><span class="annot"><span class="annottext">[Either a b]
</span><a href="#local-6989586621679026481"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-74"></span><span class="hs-comment">-- &gt;&gt;&gt; leadLeft' 0 [Right 'a', Right 'b', Left 1, Right 'c', Right 'd', Left 2, Right 'e', Right 'f']</span><span>
</span><span id="line-75"></span><span class="hs-comment">-- [(0,&quot;ab&quot;),(1,&quot;cd&quot;),(2,&quot;ef&quot;)]</span><span>
</span><span id="line-76"></span><span class="hs-comment">--</span><span>
</span><span id="line-77"></span><span class="hs-comment">-- &gt;&gt;&gt; leadLeft' 0 [Left 1, Left 2, Right 'a', Left 3, Right 'b', Right 'c']</span><span>
</span><span id="line-78"></span><span class="hs-comment">-- [(1,&quot;&quot;),(2,&quot;a&quot;),(3,&quot;bc&quot;)]</span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span id="local-6989586621679026479"><span id="local-6989586621679026480"><span class="annot"><a href="Data.List.EitherFunctions.html#leadLeft%27"><span class="hs-identifier hs-type">leadLeft'</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-81"></span><span>    </span><span class="annot"><a href="#local-6989586621679026480"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-comment">-- ^ Leader to use for the first group in case the list does not begin with a 'Left'.</span><span>
</span><span id="line-82"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679026480"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679026479"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679026480"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679026479"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span id="leadLeft%27"><span class="annot"><span class="annottext">leadLeft' :: a -&gt; [Either a b] -&gt; [(a, [b])]
</span><a href="Data.List.EitherFunctions.html#leadLeft%27"><span class="hs-identifier hs-var hs-var">leadLeft'</span></a></span></span><span> </span><span id="local-6989586621679026478"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679026478"><span class="hs-identifier hs-var">leader</span></a></span></span><span> </span><span id="local-6989586621679026477"><span class="annot"><span class="annottext">[Either a b]
</span><a href="#local-6989586621679026477"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; ([b], [(a, [b])]) -&gt; [(a, [b])]
forall a b. a -&gt; ([b], [(a, [b])]) -&gt; [(a, [b])]
</span><a href="Data.List.EitherFunctions.html#addMissingLeader"><span class="hs-identifier hs-var">addMissingLeader</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679026478"><span class="hs-identifier hs-var">leader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Either a b] -&gt; ([b], [(a, [b])])
forall a b. [Either a b] -&gt; ([b], [(a, [b])])
</span><a href="Data.List.EitherFunctions.html#leadLeft"><span class="hs-identifier hs-var">leadLeft</span></a></span><span> </span><span class="annot"><span class="annottext">[Either a b]
</span><a href="#local-6989586621679026477"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-87"></span><span class="hs-comment">-- &gt;&gt;&gt; leadRight [Left 1, Left 2, Right 'a', Left 3, Left 4, Right 'b', Left 5, Left 6]</span><span>
</span><span id="line-88"></span><span class="hs-comment">-- ([1,2],[('a',[3,4]),('b',[5,6])])</span><span>
</span><span id="line-89"></span><span class="hs-comment">--</span><span>
</span><span id="line-90"></span><span class="hs-comment">-- &gt;&gt;&gt; leadRight [Right 'a', Left 3, Left 4, Right 'b', Right 'c', Left 5, Left 6]</span><span>
</span><span id="line-91"></span><span class="hs-comment">-- ([],[('a',[3,4]),('b',[]),('c',[5,6])])</span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span id="local-6989586621679026474"><span id="local-6989586621679026475"><span class="annot"><a href="Data.List.EitherFunctions.html#leadRight"><span class="hs-identifier hs-type">leadRight</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679026475"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679026474"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679026475"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679026474"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679026475"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span id="leadRight"><span class="annot"><span class="annottext">leadRight :: [Either a b] -&gt; ([a], [(b, [a])])
</span><a href="Data.List.EitherFunctions.html#leadRight"><span class="hs-identifier hs-var hs-var">leadRight</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Either a b] -&gt; ([a], [(b, [a])])
forall a b. [Either a b] -&gt; ([a], [(b, [a])])
</span><a href="#local-6989586621679026473"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-96"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-97"></span><span>    </span><span id="local-6989586621679026473"><span class="annot"><span class="annottext">f :: [Either a b] -&gt; ([a], [(b, [a])])
</span><a href="#local-6989586621679026473"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679026472"><span class="annot"><span class="annottext">[Either a b]
</span><a href="#local-6989586621679026472"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679026471"><span class="hs-identifier hs-var">unledItems</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(b, [a])]
</span><a href="#local-6989586621679026470"><span class="hs-identifier hs-var">ledGroups</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-99"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679026471"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679026471"><span class="hs-identifier hs-var">unledItems</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679026469"><span class="annot"><span class="annottext">Maybe (b, [Either a b])
</span><a href="#local-6989586621679026469"><span class="hs-identifier hs-var">ysMaybe</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Either a b] -&gt; ([a], Maybe (b, [Either a b]))
forall a b. [Either a b] -&gt; ([a], Maybe (b, [Either a b]))
</span><a href="Data.List.EitherFunctions.html#spanLeft%27"><span class="hs-identifier hs-var">spanLeft'</span></a></span><span> </span><span class="annot"><span class="annottext">[Either a b]
</span><a href="#local-6989586621679026472"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-100"></span><span>        </span><span id="local-6989586621679026470"><span class="annot"><span class="annottext">ledGroups :: [(b, [a])]
</span><a href="#local-6989586621679026470"><span class="hs-identifier hs-var hs-var">ledGroups</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (b, [Either a b])
</span><a href="#local-6989586621679026469"><span class="hs-identifier hs-var">ysMaybe</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-101"></span><span>            </span><span class="annot"><span class="annottext">Maybe (b, [Either a b])
</span><span class="hs-identifier hs-var">Nothing</span></span><span>            </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-102"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679026468"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679026468"><span class="hs-identifier hs-var">leader</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679026467"><span class="annot"><span class="annottext">[Either a b]
</span><a href="#local-6989586621679026467"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="annot"><span class="annottext">b -&gt; [Either a b] -&gt; [(b, [a])]
forall a a. a -&gt; [Either a a] -&gt; [(a, [a])]
</span><a href="#local-6989586621679026466"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679026468"><span class="hs-identifier hs-var">leader</span></a></span><span> </span><span class="annot"><span class="annottext">[Either a b]
</span><a href="#local-6989586621679026467"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span>    </span><span id="local-6989586621679026466"><span class="annot"><span class="annottext">r :: a -&gt; [Either a a] -&gt; [(a, [a])]
</span><a href="#local-6989586621679026466"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679026465"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679026465"><span class="hs-identifier hs-var">leader</span></a></span></span><span> </span><span id="local-6989586621679026464"><span class="annot"><span class="annottext">[Either a a]
</span><a href="#local-6989586621679026464"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a, [a])
</span><a href="#local-6989586621679026463"><span class="hs-identifier hs-var">firstGroup</span></a></span><span> </span><span class="annot"><span class="annottext">(a, [a]) -&gt; [(a, [a])] -&gt; [(a, [a])]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(a, [a])]
</span><a href="#local-6989586621679026462"><span class="hs-identifier hs-var">moreGroups</span></a></span><span>
</span><span id="line-105"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-106"></span><span>        </span><span id="local-6989586621679026463"><span class="annot"><span class="annottext">firstGroup :: (a, [a])
</span><a href="#local-6989586621679026463"><span class="hs-identifier hs-var hs-var">firstGroup</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679026465"><span class="hs-identifier hs-var">leader</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679026461"><span class="hs-identifier hs-var">followers</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679026461"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679026461"><span class="hs-identifier hs-var">followers</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679026460"><span class="annot"><span class="annottext">Maybe (a, [Either a a])
</span><a href="#local-6989586621679026460"><span class="hs-identifier hs-var">ysMaybe</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Either a a] -&gt; ([a], Maybe (a, [Either a a]))
forall a b. [Either a b] -&gt; ([a], Maybe (b, [Either a b]))
</span><a href="Data.List.EitherFunctions.html#spanLeft%27"><span class="hs-identifier hs-var">spanLeft'</span></a></span><span> </span><span class="annot"><span class="annottext">[Either a a]
</span><a href="#local-6989586621679026464"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-108"></span><span>        </span><span id="local-6989586621679026462"><span class="annot"><span class="annottext">moreGroups :: [(a, [a])]
</span><a href="#local-6989586621679026462"><span class="hs-identifier hs-var hs-var">moreGroups</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (a, [Either a a])
</span><a href="#local-6989586621679026460"><span class="hs-identifier hs-var">ysMaybe</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-109"></span><span>            </span><span class="annot"><span class="annottext">Maybe (a, [Either a a])
</span><span class="hs-identifier hs-var">Nothing</span></span><span>             </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-110"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679026459"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679026459"><span class="hs-identifier hs-var">leader'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679026458"><span class="annot"><span class="annottext">[Either a a]
</span><a href="#local-6989586621679026458"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="annot"><span class="annottext">a -&gt; [Either a a] -&gt; [(a, [a])]
</span><a href="#local-6989586621679026466"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679026459"><span class="hs-identifier hs-var">leader'</span></a></span><span> </span><span class="annot"><span class="annottext">[Either a a]
</span><a href="#local-6989586621679026458"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-113"></span><span class="hs-comment">-- &gt;&gt;&gt; leadRight' 'z' [Left 1, Left 2, Right 'a', Left 3, Left 4, Right 'b', Left 5, Left 6]</span><span>
</span><span id="line-114"></span><span class="hs-comment">-- [('z',[1,2]),('a',[3,4]),('b',[5,6])]</span><span>
</span><span id="line-115"></span><span class="hs-comment">--</span><span>
</span><span id="line-116"></span><span class="hs-comment">-- &gt;&gt;&gt; leadRight' 'z' [Right 'a', Left 3, Left 4, Right 'b', Right 'c', Left 5, Left 6]</span><span>
</span><span id="line-117"></span><span class="hs-comment">-- [('a',[3,4]),('b',[]),('c',[5,6])]</span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span id="local-6989586621679026456"><span id="local-6989586621679026457"><span class="annot"><a href="Data.List.EitherFunctions.html#leadRight%27"><span class="hs-identifier hs-type">leadRight'</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-120"></span><span>    </span><span class="annot"><a href="#local-6989586621679026457"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-comment">-- ^ Leader to use for the first group in case the list does not begin with a 'Right'.</span><span>
</span><span id="line-121"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679026456"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679026457"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679026457"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679026456"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span id="leadRight%27"><span class="annot"><span class="annottext">leadRight' :: b -&gt; [Either a b] -&gt; [(b, [a])]
</span><a href="Data.List.EitherFunctions.html#leadRight%27"><span class="hs-identifier hs-var hs-var">leadRight'</span></a></span></span><span> </span><span id="local-6989586621679026455"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679026455"><span class="hs-identifier hs-var">leader</span></a></span></span><span> </span><span id="local-6989586621679026454"><span class="annot"><span class="annottext">[Either a b]
</span><a href="#local-6989586621679026454"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b -&gt; ([a], [(b, [a])]) -&gt; [(b, [a])]
forall a b. a -&gt; ([b], [(a, [b])]) -&gt; [(a, [b])]
</span><a href="Data.List.EitherFunctions.html#addMissingLeader"><span class="hs-identifier hs-var">addMissingLeader</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679026455"><span class="hs-identifier hs-var">leader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Either a b] -&gt; ([a], [(b, [a])])
forall a b. [Either a b] -&gt; ([a], [(b, [a])])
</span><a href="Data.List.EitherFunctions.html#leadRight"><span class="hs-identifier hs-var">leadRight</span></a></span><span> </span><span class="annot"><span class="annottext">[Either a b]
</span><a href="#local-6989586621679026454"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span id="local-6989586621679026576"><span id="local-6989586621679026577"><span class="annot"><a href="Data.List.EitherFunctions.html#addMissingLeader"><span class="hs-identifier hs-type">addMissingLeader</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679026577"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679026576"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679026577"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679026576"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679026577"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679026576"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span id="addMissingLeader"><span class="annot"><span class="annottext">addMissingLeader :: a -&gt; ([b], [(a, [b])]) -&gt; [(a, [b])]
</span><a href="Data.List.EitherFunctions.html#addMissingLeader"><span class="hs-identifier hs-var hs-var">addMissingLeader</span></a></span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span>      </span><span class="hs-special">(</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>         </span><span class="hs-special">,</span><span> </span><span id="local-6989586621679026453"><span class="annot"><span class="annottext">[(a, [b])]
</span><a href="#local-6989586621679026453"><span class="hs-identifier hs-var">groups</span></a></span></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>                        </span><span class="annot"><span class="annottext">[(a, [b])]
</span><a href="#local-6989586621679026453"><span class="hs-identifier hs-var">groups</span></a></span><span>
</span><span id="line-128"></span><span class="annot"><a href="Data.List.EitherFunctions.html#addMissingLeader"><span class="hs-identifier hs-var">addMissingLeader</span></a></span><span> </span><span id="local-6989586621679026452"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679026452"><span class="hs-identifier hs-var">leader</span></a></span></span><span> </span><span class="hs-special">(</span><span> </span><span id="local-6989586621679026451"><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679026451"><span class="hs-identifier hs-var">unledIntro</span></a></span></span><span> </span><span class="hs-special">,</span><span> </span><span id="local-6989586621679026450"><span class="annot"><span class="annottext">[(a, [b])]
</span><a href="#local-6989586621679026450"><span class="hs-identifier hs-var">groups</span></a></span></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679026452"><span class="hs-identifier hs-var">leader</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679026451"><span class="hs-identifier hs-var">unledIntro</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(a, [b]) -&gt; [(a, [b])] -&gt; [(a, [b])]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(a, [b])]
</span><a href="#local-6989586621679026450"><span class="hs-identifier hs-var">groups</span></a></span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-131"></span><span class="hs-comment">-- &gt;&gt;&gt; spanLeft [Left 1, Left 2, Right 'a', Left 3, Right 'b', Right 'c']</span><span>
</span><span id="line-132"></span><span class="hs-comment">-- ([1,2],[Right 'a',Left 3,Right 'b',Right 'c'])</span><span>
</span><span id="line-133"></span><span class="hs-comment">--</span><span>
</span><span id="line-134"></span><span class="hs-comment">-- &gt;&gt;&gt; spanLeft [Right 'a', Left 3, Right 'b', Right 'c']</span><span>
</span><span id="line-135"></span><span class="hs-comment">-- ([],[Right 'a',Left 3,Right 'b',Right 'c'])</span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span id="local-6989586621679026590"><span id="local-6989586621679026591"><span class="annot"><a href="Data.List.EitherFunctions.html#spanLeft"><span class="hs-identifier hs-type">spanLeft</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679026591"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679026590"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679026591"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679026591"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679026590"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span id="spanLeft"><span class="annot"><span class="annottext">spanLeft :: [Either a b] -&gt; ([a], [Either a b])
</span><a href="Data.List.EitherFunctions.html#spanLeft"><span class="hs-identifier hs-var hs-var">spanLeft</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(([Either a b] -&gt; ([a], [Either a b]))
 -&gt; [Either a b] -&gt; ([a], [Either a b]))
-&gt; [Either a b] -&gt; ([a], [Either a b])
forall a. (a -&gt; a) -&gt; a
</span><span class="hs-identifier hs-var">fix</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679026449"><span class="annot"><span class="annottext">[Either a b] -&gt; ([a], [Either a b])
</span><a href="#local-6989586621679026449"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-140"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span>           </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-141"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679026448"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679026448"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679026447"><span class="annot"><span class="annottext">[Either a b]
</span><a href="#local-6989586621679026447"><span class="hs-identifier hs-var">xs</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679026448"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679026446"><span class="hs-identifier hs-var">ys</span></a></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Either a b]
</span><a href="#local-6989586621679026445"><span class="hs-identifier hs-var">zs</span></a></span><span> </span><span class="hs-special">)</span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679026446"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679026446"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679026445"><span class="annot"><span class="annottext">[Either a b]
</span><a href="#local-6989586621679026445"><span class="hs-identifier hs-var">zs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Either a b] -&gt; ([a], [Either a b])
</span><a href="#local-6989586621679026449"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">[Either a b]
</span><a href="#local-6989586621679026447"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-142"></span><span>    </span><span id="local-6989586621679026444"><span class="annot"><span class="annottext">[Either a b]
</span><a href="#local-6989586621679026444"><span class="hs-identifier hs-var">xs</span></a></span></span><span>           </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Either a b]
</span><a href="#local-6989586621679026444"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span class="hs-comment">-- | Similar to 'spanLeft', but preserves a little more information in the return type: if the remainder of the list is non-empty, then it necessarily begins with a 'Right', and so we can go ahead and unwrap that and return it as a value of type `b`.</span><span>
</span><span id="line-145"></span><span class="hs-comment">--</span><span>
</span><span id="line-146"></span><span class="hs-comment">-- &gt;&gt;&gt; spanLeft' [Left 1, Left 2, Right 'a', Left 3, Right 'b', Right 'c']</span><span>
</span><span id="line-147"></span><span class="hs-comment">-- ([1,2],Just ('a',[Left 3,Right 'b',Right 'c']))</span><span>
</span><span id="line-148"></span><span class="hs-comment">--</span><span>
</span><span id="line-149"></span><span class="hs-comment">-- &gt;&gt;&gt; spanLeft' [Right 'a', Left 3, Right 'b', Right 'c']</span><span>
</span><span id="line-150"></span><span class="hs-comment">-- ([],Just ('a',[Left 3,Right 'b',Right 'c']))</span><span>
</span><span id="line-151"></span><span class="hs-comment">--</span><span>
</span><span id="line-152"></span><span class="hs-comment">-- &gt;&gt;&gt; spanLeft' [Left 1, Left 2, Left 3]</span><span>
</span><span id="line-153"></span><span class="hs-comment">-- ([1,2,3],Nothing)</span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span id="local-6989586621679026570"><span id="local-6989586621679026571"><span class="annot"><a href="Data.List.EitherFunctions.html#spanLeft%27"><span class="hs-identifier hs-type">spanLeft'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679026571"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679026570"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679026571"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679026570"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679026571"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679026570"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span id="spanLeft%27"><span class="annot"><span class="annottext">spanLeft' :: [Either a b] -&gt; ([a], Maybe (b, [Either a b]))
</span><a href="Data.List.EitherFunctions.html#spanLeft%27"><span class="hs-identifier hs-var hs-var">spanLeft'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(([Either a b] -&gt; ([a], Maybe (b, [Either a b])))
 -&gt; [Either a b] -&gt; ([a], Maybe (b, [Either a b])))
-&gt; [Either a b] -&gt; ([a], Maybe (b, [Either a b]))
forall a. (a -&gt; a) -&gt; a
</span><span class="hs-identifier hs-var">fix</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679026443"><span class="annot"><span class="annottext">[Either a b] -&gt; ([a], Maybe (b, [Either a b]))
</span><a href="#local-6989586621679026443"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-158"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span>            </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe (b, [Either a b])
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span>  </span><span id="local-6989586621679026442"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679026442"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679026441"><span class="annot"><span class="annottext">[Either a b]
</span><a href="#local-6989586621679026441"><span class="hs-identifier hs-var">xs</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679026442"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679026440"><span class="hs-identifier hs-var">ys</span></a></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe (b, [Either a b])
</span><a href="#local-6989586621679026439"><span class="hs-identifier hs-var">zs</span></a></span><span>           </span><span class="hs-special">)</span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679026440"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679026440"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679026439"><span class="annot"><span class="annottext">Maybe (b, [Either a b])
</span><a href="#local-6989586621679026439"><span class="hs-identifier hs-var">zs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Either a b] -&gt; ([a], Maybe (b, [Either a b]))
</span><a href="#local-6989586621679026443"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">[Either a b]
</span><a href="#local-6989586621679026441"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-160"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679026438"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679026438"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679026437"><span class="annot"><span class="annottext">[Either a b]
</span><a href="#local-6989586621679026437"><span class="hs-identifier hs-var">xs</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(b, [Either a b]) -&gt; Maybe (b, [Either a b])
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679026438"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Either a b]
</span><a href="#local-6989586621679026437"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span class="hs-comment">-- | Similar to 'spanRight', but preserves a little more information in the return type: if the remainder of the list is non-empty, then it necessarily begins with a 'Left', and so we can go ahead and unwrap that and return it as a value of type `a`.</span><span>
</span><span id="line-163"></span><span class="hs-comment">--</span><span>
</span><span id="line-164"></span><span class="hs-comment">-- &gt;&gt;&gt; spanRight [Left 1, Left 2, Right 'a', Left 3, Right 'b', Right 'c']</span><span>
</span><span id="line-165"></span><span class="hs-comment">-- (&quot;&quot;,[Left 1,Left 2,Right 'a',Left 3,Right 'b',Right 'c'])</span><span>
</span><span id="line-166"></span><span class="hs-comment">--</span><span>
</span><span id="line-167"></span><span class="hs-comment">-- &gt;&gt;&gt; spanRight [Right 'a', Left 3, Right 'b', Right 'c']</span><span>
</span><span id="line-168"></span><span class="hs-comment">-- (&quot;a&quot;,[Left 3,Right 'b',Right 'c'])</span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span id="local-6989586621679026588"><span id="local-6989586621679026589"><span class="annot"><a href="Data.List.EitherFunctions.html#spanRight"><span class="hs-identifier hs-type">spanRight</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679026589"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679026588"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679026588"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679026589"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679026588"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span id="spanRight"><span class="annot"><span class="annottext">spanRight :: [Either a b] -&gt; ([b], [Either a b])
</span><a href="Data.List.EitherFunctions.html#spanRight"><span class="hs-identifier hs-var hs-var">spanRight</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(([Either a b] -&gt; ([b], [Either a b]))
 -&gt; [Either a b] -&gt; ([b], [Either a b]))
-&gt; [Either a b] -&gt; ([b], [Either a b])
forall a. (a -&gt; a) -&gt; a
</span><span class="hs-identifier hs-var">fix</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679026436"><span class="annot"><span class="annottext">[Either a b] -&gt; ([b], [Either a b])
</span><a href="#local-6989586621679026436"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-173"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span>            </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-174"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679026435"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679026435"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679026434"><span class="annot"><span class="annottext">[Either a b]
</span><a href="#local-6989586621679026434"><span class="hs-identifier hs-var">xs</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679026435"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; [b] -&gt; [b]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679026433"><span class="hs-identifier hs-var">ys</span></a></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Either a b]
</span><a href="#local-6989586621679026432"><span class="hs-identifier hs-var">zs</span></a></span><span> </span><span class="hs-special">)</span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679026433"><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679026433"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679026432"><span class="annot"><span class="annottext">[Either a b]
</span><a href="#local-6989586621679026432"><span class="hs-identifier hs-var">zs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Either a b] -&gt; ([b], [Either a b])
</span><a href="#local-6989586621679026436"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">[Either a b]
</span><a href="#local-6989586621679026434"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-175"></span><span>    </span><span id="local-6989586621679026431"><span class="annot"><span class="annottext">[Either a b]
</span><a href="#local-6989586621679026431"><span class="hs-identifier hs-var">xs</span></a></span></span><span>            </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Either a b]
</span><a href="#local-6989586621679026431"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-178"></span><span class="hs-comment">-- &gt;&gt;&gt; spanRight' [Left 1, Left 2, Right 'a', Left 3, Right 'b', Right 'c']</span><span>
</span><span id="line-179"></span><span class="hs-comment">-- (&quot;&quot;,Just (1,[Left 2,Right 'a',Left 3,Right 'b',Right 'c']))</span><span>
</span><span id="line-180"></span><span class="hs-comment">--</span><span>
</span><span id="line-181"></span><span class="hs-comment">-- &gt;&gt;&gt; spanRight' [Right 'a', Left 3, Right 'b', Right 'c']</span><span>
</span><span id="line-182"></span><span class="hs-comment">-- (&quot;a&quot;,Just (3,[Right 'b',Right 'c']))</span><span>
</span><span id="line-183"></span><span class="hs-comment">--</span><span>
</span><span id="line-184"></span><span class="hs-comment">-- &gt;&gt;&gt; spanRight' [Right 'a', Right 'b', Right 'c']</span><span>
</span><span id="line-185"></span><span class="hs-comment">-- (&quot;abc&quot;,Nothing)</span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span id="local-6989586621679026582"><span id="local-6989586621679026583"><span class="annot"><a href="Data.List.EitherFunctions.html#spanRight%27"><span class="hs-identifier hs-type">spanRight'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679026583"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679026582"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679026582"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679026583"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679026583"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679026582"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span id="spanRight%27"><span class="annot"><span class="annottext">spanRight' :: [Either a b] -&gt; ([b], Maybe (a, [Either a b]))
</span><a href="Data.List.EitherFunctions.html#spanRight%27"><span class="hs-identifier hs-var hs-var">spanRight'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(([Either a b] -&gt; ([b], Maybe (a, [Either a b])))
 -&gt; [Either a b] -&gt; ([b], Maybe (a, [Either a b])))
-&gt; [Either a b] -&gt; ([b], Maybe (a, [Either a b]))
forall a. (a -&gt; a) -&gt; a
</span><span class="hs-identifier hs-var">fix</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679026430"><span class="annot"><span class="annottext">[Either a b] -&gt; ([b], Maybe (a, [Either a b]))
</span><a href="#local-6989586621679026430"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-190"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span>            </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe (a, [Either a b])
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-191"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679026429"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679026429"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679026428"><span class="annot"><span class="annottext">[Either a b]
</span><a href="#local-6989586621679026428"><span class="hs-identifier hs-var">xs</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679026429"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; [b] -&gt; [b]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679026427"><span class="hs-identifier hs-var">ys</span></a></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe (a, [Either a b])
</span><a href="#local-6989586621679026426"><span class="hs-identifier hs-var">zs</span></a></span><span>           </span><span class="hs-special">)</span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679026427"><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679026427"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679026426"><span class="annot"><span class="annottext">Maybe (a, [Either a b])
</span><a href="#local-6989586621679026426"><span class="hs-identifier hs-var">zs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Either a b] -&gt; ([b], Maybe (a, [Either a b]))
</span><a href="#local-6989586621679026430"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">[Either a b]
</span><a href="#local-6989586621679026428"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-192"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span>  </span><span id="local-6989586621679026425"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679026425"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679026424"><span class="annot"><span class="annottext">[Either a b]
</span><a href="#local-6989586621679026424"><span class="hs-identifier hs-var">xs</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(a, [Either a b]) -&gt; Maybe (a, [Either a b])
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679026425"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Either a b]
</span><a href="#local-6989586621679026424"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-195"></span><span class="hs-comment">-- &gt;&gt;&gt; partition [Left 1, Left 2, Right 'a', Left 3, Right 'b', Right 'c']</span><span>
</span><span id="line-196"></span><span class="hs-comment">-- ([1,2,3],&quot;abc&quot;)</span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span id="local-6989586621679026422"><span id="local-6989586621679026423"><span class="annot"><a href="Data.List.EitherFunctions.html#partition"><span class="hs-identifier hs-type">partition</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679026423"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679026422"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679026423"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679026422"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span id="partition"><span class="annot"><span class="annottext">partition :: [Either a b] -&gt; ([a], [b])
</span><a href="Data.List.EitherFunctions.html#partition"><span class="hs-identifier hs-var hs-var">partition</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(([Either a b] -&gt; ([a], [b])) -&gt; [Either a b] -&gt; ([a], [b]))
-&gt; [Either a b] -&gt; ([a], [b])
forall a. (a -&gt; a) -&gt; a
</span><span class="hs-identifier hs-var">fix</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679026421"><span class="annot"><span class="annottext">[Either a b] -&gt; ([a], [b])
</span><a href="#local-6989586621679026421"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-201"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span>            </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-special">)</span><span>
</span><span id="line-202"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span>  </span><span id="local-6989586621679026420"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679026420"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679026419"><span class="annot"><span class="annottext">[Either a b]
</span><a href="#local-6989586621679026419"><span class="hs-identifier hs-var">xs</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679026420"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679026418"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679026417"><span class="hs-identifier hs-var">bs</span></a></span><span>     </span><span class="hs-special">)</span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679026418"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679026418"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679026417"><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679026417"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Either a b] -&gt; ([a], [b])
</span><a href="#local-6989586621679026421"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">[Either a b]
</span><a href="#local-6989586621679026419"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-203"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679026416"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679026416"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679026415"><span class="annot"><span class="annottext">[Either a b]
</span><a href="#local-6989586621679026415"><span class="hs-identifier hs-var">xs</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679026414"><span class="hs-keyword hs-var">as</span></a></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679026416"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; [b] -&gt; [b]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679026413"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="hs-special">)</span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679026414"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679026414"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679026413"><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679026413"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Either a b] -&gt; ([a], [b])
</span><a href="#local-6989586621679026421"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">[Either a b]
</span><a href="#local-6989586621679026415"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span class="hs-comment">-- | The relative significance of branches (greater values are closer to the root).</span><span>
</span><span id="line-206"></span><span class="hs-keyword">type</span><span> </span><span id="BranchComparison"><span class="annot"><a href="Data.List.EitherFunctions.html#BranchComparison"><span class="hs-identifier hs-var">BranchComparison</span></a></span></span><span> </span><span id="local-6989586621679026412"><span class="annot"><a href="#local-6989586621679026412"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Comparison</span></span><span> </span><span class="annot"><a href="#local-6989586621679026412"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-207"></span><span>
</span><span id="line-208"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-209"></span><span class="hs-comment">-- &gt;&gt;&gt; import Prelude</span><span>
</span><span id="line-210"></span><span class="hs-comment">--</span><span>
</span><span id="line-211"></span><span class="hs-comment">-- &gt;&gt;&gt; heading level title = Left (level, title)</span><span>
</span><span id="line-212"></span><span class="hs-comment">-- &gt;&gt;&gt; chapter = heading 1</span><span>
</span><span id="line-213"></span><span class="hs-comment">-- &gt;&gt;&gt; section = heading 2</span><span>
</span><span id="line-214"></span><span class="hs-comment">-- &gt;&gt;&gt; p text = Right text</span><span>
</span><span id="line-215"></span><span class="hs-comment">--</span><span>
</span><span id="line-216"></span><span class="hs-comment">-- &gt;&gt;&gt; :{</span><span>
</span><span id="line-217"></span><span class="hs-comment">-- &gt;&gt;&gt; list =</span><span>
</span><span id="line-218"></span><span class="hs-comment">-- &gt;&gt;&gt;     [ p &quot;Copyright&quot;</span><span>
</span><span id="line-219"></span><span class="hs-comment">-- &gt;&gt;&gt;     , p &quot;Preface&quot;</span><span>
</span><span id="line-220"></span><span class="hs-comment">-- &gt;&gt;&gt;     , chapter &quot;Animals&quot;</span><span>
</span><span id="line-221"></span><span class="hs-comment">-- &gt;&gt;&gt;     , p &quot;The kingdom animalia&quot;</span><span>
</span><span id="line-222"></span><span class="hs-comment">-- &gt;&gt;&gt;     , section &quot;Vertibrates&quot;</span><span>
</span><span id="line-223"></span><span class="hs-comment">-- &gt;&gt;&gt;     , p &quot;Cats&quot;</span><span>
</span><span id="line-224"></span><span class="hs-comment">-- &gt;&gt;&gt;     , p &quot;Snakes&quot;</span><span>
</span><span id="line-225"></span><span class="hs-comment">-- &gt;&gt;&gt;     , section &quot;Invertibrates&quot;</span><span>
</span><span id="line-226"></span><span class="hs-comment">-- &gt;&gt;&gt;     , p &quot;Worms&quot;</span><span>
</span><span id="line-227"></span><span class="hs-comment">-- &gt;&gt;&gt;     , p &quot;Jellyfishes&quot;</span><span>
</span><span id="line-228"></span><span class="hs-comment">-- &gt;&gt;&gt;     , chapter &quot;Fungus&quot;</span><span>
</span><span id="line-229"></span><span class="hs-comment">-- &gt;&gt;&gt;     , p &quot;Yeast&quot;</span><span>
</span><span id="line-230"></span><span class="hs-comment">-- &gt;&gt;&gt;     , p &quot;Truffles&quot;</span><span>
</span><span id="line-231"></span><span class="hs-comment">-- &gt;&gt;&gt;     , p &quot;Morels&quot;</span><span>
</span><span id="line-232"></span><span class="hs-comment">-- &gt;&gt;&gt;     ]</span><span>
</span><span id="line-233"></span><span class="hs-comment">-- &gt;&gt;&gt; :}</span><span>
</span><span id="line-234"></span><span class="hs-comment">--</span><span>
</span><span id="line-235"></span><span class="hs-comment">-- &gt;&gt;&gt; import Data.Functor.Contravariant</span><span>
</span><span id="line-236"></span><span class="hs-comment">-- &gt;&gt;&gt; flipComparison (Comparison f) = Comparison (flip f)</span><span>
</span><span id="line-237"></span><span class="hs-comment">-- &gt;&gt;&gt; headingComparison = contramap fst (flipComparison defaultComparison)</span><span>
</span><span id="line-238"></span><span class="hs-comment">--</span><span>
</span><span id="line-239"></span><span class="hs-comment">-- &gt;&gt;&gt; (frontMatter, mainMatter) = branchLeft headingComparison list</span><span>
</span><span id="line-240"></span><span class="hs-comment">--</span><span>
</span><span id="line-241"></span><span class="hs-comment">-- &gt;&gt;&gt; frontMatter</span><span>
</span><span id="line-242"></span><span class="hs-comment">-- [&quot;Copyright&quot;,&quot;Preface&quot;]</span><span>
</span><span id="line-243"></span><span class="hs-comment">--</span><span>
</span><span id="line-244"></span><span class="hs-comment">-- &gt;&gt;&gt; import Data.List</span><span>
</span><span id="line-245"></span><span class="hs-comment">-- &gt;&gt;&gt; showContent ((_, x), ys) = x ++ &quot;: &quot; ++ intercalate &quot;, &quot; ys</span><span>
</span><span id="line-246"></span><span class="hs-comment">--</span><span>
</span><span id="line-247"></span><span class="hs-comment">-- &gt;&gt;&gt; import Data.Tree</span><span>
</span><span id="line-248"></span><span class="hs-comment">-- &gt;&gt;&gt; putStrLn $ drawForest $ map (fmap showContent) mainMatter</span><span>
</span><span id="line-249"></span><span class="hs-comment">-- Animals: The kingdom animalia</span><span>
</span><span id="line-250"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-251"></span><span class="hs-comment">-- +- Vertibrates: Cats, Snakes</span><span>
</span><span id="line-252"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-253"></span><span class="hs-comment">-- `- Invertibrates: Worms, Jellyfishes</span><span>
</span><span id="line-254"></span><span class="hs-comment">-- &lt;BLANKLINE&gt;</span><span>
</span><span id="line-255"></span><span class="hs-comment">-- Fungus: Yeast, Truffles, Morels</span><span>
</span><span id="line-256"></span><span class="hs-comment">-- &lt;BLANKLINE&gt;</span><span>
</span><span id="line-257"></span><span class="hs-comment">-- &lt;BLANKLINE&gt;</span><span>
</span><span id="line-258"></span><span>
</span><span id="line-259"></span><span id="local-6989586621679026410"><span id="local-6989586621679026411"><span class="annot"><a href="Data.List.EitherFunctions.html#branchLeft"><span class="hs-identifier hs-type">branchLeft</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.List.EitherFunctions.html#BranchComparison"><span class="hs-identifier hs-type">BranchComparison</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679026411"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679026411"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679026410"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679026410"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Forest</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679026411"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679026410"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-260"></span><span>
</span><span id="line-261"></span><span id="branchLeft"><span class="annot"><span class="annottext">branchLeft :: BranchComparison a -&gt; [Either a b] -&gt; ([b], Forest (a, [b]))
</span><a href="Data.List.EitherFunctions.html#branchLeft"><span class="hs-identifier hs-var hs-var">branchLeft</span></a></span></span><span> </span><span id="local-6989586621679026409"><span class="annot"><span class="annottext">BranchComparison a
</span><a href="#local-6989586621679026409"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679026408"><span class="annot"><span class="annottext">[Either a b]
</span><a href="#local-6989586621679026408"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679026407"><span class="hs-identifier hs-var">rejects</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Forest (a, [b])
</span><a href="#local-6989586621679026406"><span class="hs-identifier hs-var">forest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-262"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-263"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679026407"><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679026407"><span class="hs-identifier hs-var">rejects</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679026405"><span class="annot"><span class="annottext">[(a, [b])]
</span><a href="#local-6989586621679026405"><span class="hs-identifier hs-var">nodes</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Either a b] -&gt; ([b], [(a, [b])])
forall a b. [Either a b] -&gt; ([b], [(a, [b])])
</span><a href="Data.List.EitherFunctions.html#leadLeft"><span class="hs-identifier hs-var">leadLeft</span></a></span><span> </span><span class="annot"><span class="annottext">[Either a b]
</span><a href="#local-6989586621679026408"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-264"></span><span>    </span><span id="local-6989586621679026406"><span class="annot"><span class="annottext">forest :: Forest (a, [b])
</span><a href="#local-6989586621679026406"><span class="hs-identifier hs-var hs-var">forest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BranchComparison (a, [b]) -&gt; [(a, [b])] -&gt; Forest (a, [b])
forall a. BranchComparison a -&gt; [a] -&gt; Forest a
</span><a href="Data.List.EitherFunctions.html#makeForest"><span class="hs-identifier hs-var">makeForest</span></a></span><span> </span><span class="annot"><span class="annottext">BranchComparison (a, [b])
forall b. Comparison (a, b)
</span><a href="#local-6989586621679026403"><span class="hs-identifier hs-var">c'</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, [b])]
</span><a href="#local-6989586621679026405"><span class="hs-identifier hs-var">nodes</span></a></span><span>
</span><span id="line-265"></span><span>    </span><span id="local-6989586621679026403"><span class="annot"><span class="annottext">c' :: Comparison (a, b)
</span><a href="#local-6989586621679026403"><span class="hs-identifier hs-var hs-var">c'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((a, b) -&gt; a) -&gt; BranchComparison a -&gt; Comparison (a, b)
forall (f :: * -&gt; *) a b. Contravariant f =&gt; (a -&gt; b) -&gt; f b -&gt; f a
</span><span class="hs-identifier hs-var">contramap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679026402"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679026402"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679026402"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">BranchComparison a
</span><a href="#local-6989586621679026409"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-266"></span><span>
</span><span id="line-267"></span><span class="hs-comment">-- | Same as 'branchLeft', but with the types flipped; here, 'Right' is the case that indicates a branch.</span><span>
</span><span id="line-268"></span><span>
</span><span id="line-269"></span><span id="local-6989586621679026400"><span id="local-6989586621679026401"><span class="annot"><a href="Data.List.EitherFunctions.html#branchRight"><span class="hs-identifier hs-type">branchRight</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.List.EitherFunctions.html#BranchComparison"><span class="hs-identifier hs-type">BranchComparison</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679026401"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679026400"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679026401"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679026400"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Forest</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679026401"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679026400"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-270"></span><span>
</span><span id="line-271"></span><span id="branchRight"><span class="annot"><span class="annottext">branchRight :: BranchComparison b -&gt; [Either a b] -&gt; ([a], Forest (b, [a]))
</span><a href="Data.List.EitherFunctions.html#branchRight"><span class="hs-identifier hs-var hs-var">branchRight</span></a></span></span><span> </span><span id="local-6989586621679026399"><span class="annot"><span class="annottext">BranchComparison b
</span><a href="#local-6989586621679026399"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679026398"><span class="annot"><span class="annottext">[Either a b]
</span><a href="#local-6989586621679026398"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679026397"><span class="hs-identifier hs-var">rejects</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Forest (b, [a])
</span><a href="#local-6989586621679026396"><span class="hs-identifier hs-var">forest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-272"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-273"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679026397"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679026397"><span class="hs-identifier hs-var">rejects</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679026395"><span class="annot"><span class="annottext">[(b, [a])]
</span><a href="#local-6989586621679026395"><span class="hs-identifier hs-var">nodes</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Either a b] -&gt; ([a], [(b, [a])])
forall a b. [Either a b] -&gt; ([a], [(b, [a])])
</span><a href="Data.List.EitherFunctions.html#leadRight"><span class="hs-identifier hs-var">leadRight</span></a></span><span> </span><span class="annot"><span class="annottext">[Either a b]
</span><a href="#local-6989586621679026398"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-274"></span><span>    </span><span id="local-6989586621679026396"><span class="annot"><span class="annottext">forest :: Forest (b, [a])
</span><a href="#local-6989586621679026396"><span class="hs-identifier hs-var hs-var">forest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BranchComparison (b, [a]) -&gt; [(b, [a])] -&gt; Forest (b, [a])
forall a. BranchComparison a -&gt; [a] -&gt; Forest a
</span><a href="Data.List.EitherFunctions.html#makeForest"><span class="hs-identifier hs-var">makeForest</span></a></span><span> </span><span class="annot"><span class="annottext">BranchComparison (b, [a])
forall b. Comparison (b, b)
</span><a href="#local-6989586621679026394"><span class="hs-identifier hs-var">c'</span></a></span><span> </span><span class="annot"><span class="annottext">[(b, [a])]
</span><a href="#local-6989586621679026395"><span class="hs-identifier hs-var">nodes</span></a></span><span>
</span><span id="line-275"></span><span>    </span><span id="local-6989586621679026394"><span class="annot"><span class="annottext">c' :: Comparison (b, b)
</span><a href="#local-6989586621679026394"><span class="hs-identifier hs-var hs-var">c'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((b, b) -&gt; b) -&gt; BranchComparison b -&gt; Comparison (b, b)
forall (f :: * -&gt; *) a b. Contravariant f =&gt; (a -&gt; b) -&gt; f b -&gt; f a
</span><span class="hs-identifier hs-var">contramap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679026393"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679026393"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679026393"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">BranchComparison b
</span><a href="#local-6989586621679026399"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-276"></span><span>
</span><span id="line-277"></span><span id="local-6989586621679026549"><span class="annot"><a href="Data.List.EitherFunctions.html#makeForest"><span class="hs-identifier hs-type">makeForest</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.List.EitherFunctions.html#BranchComparison"><span class="hs-identifier hs-type">BranchComparison</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679026549"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679026549"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Forest</span></span><span> </span><span class="annot"><a href="#local-6989586621679026549"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-278"></span><span>
</span><span id="line-279"></span><span id="makeForest"><span class="annot"><span class="annottext">makeForest :: BranchComparison a -&gt; [a] -&gt; Forest a
</span><a href="Data.List.EitherFunctions.html#makeForest"><span class="hs-identifier hs-var hs-var">makeForest</span></a></span></span><span> </span><span id="local-6989586621679026392"><span class="annot"><span class="annottext">BranchComparison a
</span><a href="#local-6989586621679026392"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Forest a -&gt; Forest a) -&gt; Forest a -&gt; [a] -&gt; Forest a
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Forest a -&gt; Forest a
</span><a href="#local-6989586621679026391"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-280"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-281"></span><span>    </span><span id="local-6989586621679026391"><span class="annot"><span class="annottext">f :: a -&gt; Forest a -&gt; Forest a
</span><a href="#local-6989586621679026391"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679026390"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679026390"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679026389"><span class="annot"><span class="annottext">Forest a
</span><a href="#local-6989586621679026389"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Forest a -&gt; Tree a
forall a. a -&gt; Forest a -&gt; Tree a
</span><span class="hs-identifier hs-var">Node</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679026390"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Forest a
</span><a href="#local-6989586621679026387"><span class="hs-identifier hs-var">chomped</span></a></span><span> </span><span class="annot"><span class="annottext">Tree a -&gt; Forest a -&gt; Forest a
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Forest a
</span><a href="#local-6989586621679026386"><span class="hs-identifier hs-var">remainder</span></a></span><span>
</span><span id="line-282"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-283"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679026387"><span class="annot"><span class="annottext">Forest a
</span><a href="#local-6989586621679026387"><span class="hs-identifier hs-var">chomped</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679026386"><span class="annot"><span class="annottext">Forest a
</span><a href="#local-6989586621679026386"><span class="hs-identifier hs-var">remainder</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Tree a -&gt; Bool) -&gt; Forest a -&gt; (Forest a, Forest a)
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">span</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Node</span></span><span> </span><span id="local-6989586621679026385"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679026385"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="annot"><span class="annottext">Forest a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679026390"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
</span><a href="#local-6989586621679026384"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679026385"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Forest a
</span><a href="#local-6989586621679026389"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-284"></span><span>
</span><span id="line-285"></span><span>    </span><span id="local-6989586621679026383"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679026383"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679026384"><span class="annot"><span class="annottext">&gt; :: a -&gt; a -&gt; Bool
</span><a href="#local-6989586621679026384"><span class="hs-operator hs-var hs-var">&gt;</span></a></span></span><span> </span><span id="local-6989586621679026382"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679026382"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">BranchComparison a -&gt; a -&gt; a -&gt; Ordering
forall a. Comparison a -&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var hs-var">getComparison</span></span><span> </span><span class="annot"><span class="annottext">BranchComparison a
</span><a href="#local-6989586621679026392"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679026383"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679026382"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-286"></span></pre></body></html>